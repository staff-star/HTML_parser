# CSV処理ツール - HTML生成

楽天・Yahoo!用のHTMLを一括生成するツールです。

## 機能

- CSVファイル（C列・D列）から商品情報を抽出
- 4つのHTMLバリアントを自動生成
  - 楽天パソコン（E列）
  - 楽天スマホ（F列）
  - Yahoo!パソコン（G列）
  - Yahoo!スマホ（H列）
- 既存の画像・リンク要素を保持（楽天版のみ）
- ローカルブラウザでプレビュー表示

## 使い方

### 1. CSVファイルの処理

```bash
python process_csv.py
```

これにより以下が実行されます：
- 入力CSVを読み込み
- 各行の商品情報を解析
- HTMLGeneratorで4つのバリアントを生成
- `output_result.csv`に結果を保存

### 2. 結果をブラウザで確認

```bash
python generate_viewer.py
```

これにより：
- `viewer.html`が生成されます
- ブラウザで開いて結果を確認できます

または、以下のコマンドで一括実行：

```bash
python run_all.py
```

## ファイル構成

```
csv_processor/
├── README.md              # このファイル
├── process_csv.py         # CSV処理スクリプト
├── generate_viewer.py     # ビューアー生成スクリプト
├── run_all.py            # 一括実行スクリプト
├── output_result.csv     # 処理結果（生成後）
└── viewer.html           # プレビューページ（生成後）
```

## 処理ルール

### 画像・リンク要素

D列（スマートフォン用商品説明文）から以下を抽出：
- `<a>`タグ
- `<img>`タグ

これらは：
- **楽天版（E, F列）**: 先頭に追加
- **Yahoo!版（G, H列）**: 追加しない

### 商品情報抽出

C列とD列から以下を抽出：
- `<table>`内の情報（品名、原材料、内容量など）
- `<p>`タグ内のテキスト

これらをパースしてHTML生成に使用

## 注意事項

- 本体ファイル構成には影響しません（一時作業フォルダ内で完結）
- 処理結果は`output_result.csv`に保存されます
- 元のCSVファイルは変更されません
